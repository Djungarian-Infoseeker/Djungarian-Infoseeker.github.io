<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第四章：模型物理过程</title>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>
<body>
    <h1>第四章：模型物理过程</h1>
    <p>
        正如第二章所述，CAM 5.0 的总参数化包由一系列组件组成，表示为：
    </p>
    <p>
        $$ P = \{M, R, S, T\}, $$
    </p>
    <p>
        其中 \(M\) 表示（湿）降水过程，\(R\) 表示云和辐射，\(S\) 表示地表模型，\(T\) 表示湍流混合。
    </p>
    <p>
        每个组件又细分为多个部分：
        \(M\) 包括一个可选的干绝热调整（通常仅应用于平流层）、湿穿透对流、浅对流和大尺度稳定凝结；
        \(R\) 首先计算云参数化，然后计算辐射参数化；
        \(S\) 提供从陆地、海洋和海冰模型获得的地表通量，或者基于指定的地表条件（如海表温度和海冰分布）计算通量。
        这些地表通量为湍流混合 \(T\) 提供了下边界条件，\(T\) 包括行星边界层参数化、垂直扩散和重力波拖曳。
    </p>
    <hr>
    <p>
        上述段落中提到的变量更新（除温度外）是直接的。
        然而，温度的更新稍微复杂一些，它遵循 Boville 和 Bretherton [2003a] 描述的基于干静能的通用方法。
        每个时间分裂参数化组件更新后的状态变量是干静能 \(s_i\)。
        假设 \(i\) 是一系列时间分裂过程中的索引。
        在第 \(i\) 个过程结束时的干静能为 \(s_i\)。
        干静能通过第 \(i\) 个过程计算的加热率 \(Q\) 来更新：
    </p>
    <p>
        $$ s_i = s_{i-1} + (\Delta t) Q_i(s_{i-1}, T_{i-1}, \Phi_{i-1}, q_{i-1}, \ldots). $$
    </p>
    <p>
        （4.2）
    </p>
    <p>
        对于不基于干静能而是基于温度倾向公式化的过程，加热率由以下公式给出：
    </p>
    <p>
        $$ Q_i = \frac{T_i - T_{i-1}}{C_p \Delta t}. $$
    </p>
    <hr>
    <p>
        温度 \(T_i\) 和重力势能 \(\Phi_i\) 通过以下公式从干静能 \(s_i\) 中反算得到：
    </p>
    <p>
        $$ s = C_p T + gz = C_p T + \Phi, $$
    </p>
    <p>
        结合静力学方程替代 \(\Phi\)：
    </p>
    <p>
        $$ \Phi_k = \Phi_s + R \sum_{l=k}^H H_{kl} T_{vl}. $$
    </p>
    <p>
        （4.3, 4.4）
    </p>
    <hr>
    <p>
        每个过程的温度倾向也在整个过程中累积。
        对于基于干静能公式化的过程，温度倾向由干静能的倾向计算得到。
        假设 \(\frac{\Delta T_i}{\Delta t}\) 表示第 \(i\) 个过程结束时的总累积，则有：
    </p>
    <p>
        $$ \frac{\Delta T_i}{\Delta t} = \frac{\Delta T_{i-1}}{\Delta t} + \frac{\Delta s_i}{C_p \Delta t}, $$
    </p>
    <p>
        其中：
    </p>
    <p>
        $$ \frac{\Delta s_i}{\Delta t} = \frac{s_i - s_{i-1}}{\Delta t}. $$
    </p>
    <p>
        （4.5, 4.6）
    </p>
    <p>
        这里假设 \(\Phi\) 不变。
        注意，\(s\) 的反算会导致 \(T\) 和 \(\Phi\) 变化。
        这种变化未计入上述公式中。
        对于不基于干静能而是基于温度倾向公式化的过程，这种倾向会直接累积。
    </p>
    <hr>
    <p>
        在最后一个参数化完成后，最后更新的干静能会被保存下来。
        这个最终的列能量会在下一次物理计算开始时用于计算与动力核心相关的全局能量修正。
        这意味着，将上述 \(T\) 传递给有限体积（FV）动力核心而不是通过干静能反算得到的 \(T\) 所引入的能量不一致性，会包含在归因于动力学的修正中。
    </p>
    <p>
        累积的物理温度倾向也在最后一个参数化完成后可用，\(\frac{\Delta T_I}{\Delta t}\)。
        从中可以通过以下公式计算出更新后的温度：
    </p>
    <p>
        $$ T_I = T_0 + \frac{\Delta T_I}{\Delta t} \cdot \Delta t. $$
    </p>
    <p>
        （4.7）
    </p>
    <p>
        这个温度被转换为虚拟位温并传递给有限体积动力核心。
        温度倾向本身被传递给谱变换欧拉和半拉格朗日动力核心。
        上述温度和干静能使用中的不一致性在模型的未来版本中应被消除。
    </p>
</body>
</html>
