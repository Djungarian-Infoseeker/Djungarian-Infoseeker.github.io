# 前言
气候动力学是气候学、大气动力学、物理海洋学等方面研究最基础的课程，所以我将其选为重点学习的科目。自己在本科阶段曾经学过《物理海洋学》课程，但是一直觉得还应该再深入一点，打好基本功。
这里使用的是英国埃克斯特大学Geoffrey K. Vallis撰写的Essentials of Atmospheric and Oceanic Dynamics作为基本参考。
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .abstract {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 20px 0;
            background-color: #f9f9f9;
        }
    </style>
</head>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大气与海洋动力学引言</title>
    <style>
        h1, h2, h3 {
            text-align: center;
            margin-top: 30px;
        }
        p {
            text-indent: 2em;
        }
        .note {
            font-style: italic;
            color: gray;
        }
        ul {
            margin-left: 2em;
        }
        li {
            margin-bottom: 0.5em;
        }
    </style>
</head>
<body>

<h1>引言</h1>
<p>
这是一本关于<strong>大气和海洋动力学</strong>的入门书籍，结合了适量的<strong>地球物理流体动力学</strong>内容。本书大致针对<strong>高年级本科生</strong>或<strong>初级研究生</strong>，但部分内容也适合<strong>一、二年级本科生</strong>阅读。我希望<strong>实践科学家们</strong>也能发现这本书的实用价值。
</p>

<p>
本书专为那些希望对该主题有初步了解的<strong>学生和科学家</strong>设计，但他们可能暂时不需要所有的细节。本书的先决条件仅是熟悉一些<strong>向量微积分</strong>和<strong>基础经典物理学</strong>。因此，本书旨在对<strong>非专业学生</strong>也具有可读性，哪怕他们将来不一定会成为专业的动力学家。
</p>

<p>
然而，除了非常基础的内容外，本书还包括一些<strong>高级主题</strong>的初步介绍，例如<strong>残余环流</strong>和<strong>湍流理论</strong>，以及关于<strong>大气和海洋一般环流</strong>的材料。更高级的部分对于初次课程来说可以跳过，类似于高难度的滑雪坡道，用<strong>菱形符号 (♦)</strong>标记。
</p>

<p>
读者可以在提供的<strong>参考文献</strong>中进一步探索这些主题，或在本书的“母版”——《<strong>大气与海洋流体动力学</strong>》中找到更详细的讨论。本书中几乎所有主题，除了<strong>行星大气</strong>一章，都在该书中有更深入的阐述。
</p>

<h2>书中内容</h2>
<p>
本书分为<strong>三部分</strong>。第一部分，也是最长的部分，为<strong>大气和海洋动力学的研究</strong>提供了基础。它不假设读者具备<strong>流体动力学</strong>或<strong>热力学</strong>的先验知识，尽管已经有这些知识的读者可能可以跳过<strong>第1章</strong>。
</p>

<p>
第一部分的其余部分介绍了<strong>地球物理流体动力学</strong>，这是<strong>大气和海洋动力学</strong>的核心主题，离开它，这门学科将大部分停留在<strong>定性</strong>和/或<strong>计算层面</strong>。我们在这里讨论了<strong>旋转和分层</strong>的影响，进而引入了<strong>浅水理论</strong>和<strong>准地转方程</strong>及<strong>行星地转方程</strong>。
</p>

<p>
<strong>罗斯贝波 (Rossby Waves)</strong>、<strong>重力波 (Gravity Waves)</strong>、<strong>斜压不稳定性 (Baroclinic Instability)</strong>，以及<strong>波平均流相互作用</strong>和<strong>湍流</strong>的初步处理，构成了<strong>第一部分</strong>的结尾。
</p>

<h2>第二部分与第三部分</h2>
<p>
<strong>第二部分</strong>和<strong>第三部分</strong>分别关注<strong>大气</strong>和<strong>海洋</strong>的大尺度动力学与环流。这两部分的核心是所谓的<strong>一般环流 (General Circulation)</strong>，意思是较大尺度上<strong>准稳定</strong>和<strong>时间平均</strong>的环流。这种环流依赖于<strong>时间相关涡旋</strong>的效应——大气的<strong>费雷尔环流 (Ferrel Cell)</strong> 可以被认为是由<strong>不稳定性</strong>和<strong>罗斯贝波</strong>驱动的。
</p>

<p>
在<strong>最后一章</strong>中描述的<strong>厄尔尼诺现象 (El Niño Phenomenon)</strong>，是显式时间相关的。本书的一个特点是专门讨论<strong>行星大气</strong>的普遍原理，这是母版书中没有的内容。这个主题因对<strong>太阳系及更遥远行星的观测</strong>而变得越来越重要。
</p>

<h2>如何使用本书</h2>
<p>
本书的内容足以支撑<strong>两个学期</strong>的大气-海洋动力学课程。一个<strong>长期学期</strong>，第一门地球物理流体动力学课程，可以基于<strong>第一部分</strong>，根据学生的背景和兴趣跳过早期或后期章节。
</p>

<p>
另一个长期课程，大气或海洋环流课程，可以基于<strong>第二部分</strong>或<strong>第三部分</strong>，并根据需要补充文献综述或研究论文，使用数据集进行实际世界（及其他行星，如果研究<strong>第13章</strong>）的分析。
</p>

<h2>致谢</h2>
<p>
我想感谢<strong>Matt Lloyd</strong>、<strong>Zoë Pruce</strong> 和<strong>Richard Smith</strong>，他们在撰写和出版过程中提供了专家指导。同时感谢我的<strong>同事</strong>和<strong>学生们</strong>——他们提供了大量的建议和批评。如果你，作为读者，有任何<strong>评论</strong>或<strong>建议</strong>，请随时联系我。
</p>

</body>
</html>


# 第一部分：地球流体力学
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>流体基础</title>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'SimSun', serif;
            line-height: 1.8;
            margin: 20px;
        }
        h1, h2 {
            text-align: center;
        }
        p {
            text-indent: 2em;
        }
        .formula {
            text-align: center;
            margin: 20px 0;
        }
        .note {
            font-style: italic;
            color: gray;
        }
        ul {
            margin-left: 2em;
        }
        li {
            margin-bottom: 0.5em;
        }
    </style>
</head>
<body>

<h1>第1章：流体基础</h1>

<h2>1.1 流体的时间导数</h2>
<h3>1.1.1 场与物质视角</h3>

<p>
在<strong>固体力学</strong>中，我们通常关注<strong>可识别物体</strong>（如足球或行星）的<strong>位置</strong>和<strong>动量</strong>，因为它们在空间中移动。从原则上讲，我们可以以相同的方式处理流体，并尝试跟踪单个流体微团的性质，如它们在流动过程中变热或变冷。这种视角被称为<strong>物质视角</strong>或<strong>拉格朗日视角 (Lagrangian Viewpoint)</strong>。
</p>
<p>
然而，在<strong>流体动力学</strong>问题中，我们通常更关心<strong>固定点</strong>在时间推移下的<strong>速度</strong>、<strong>密度</strong>等数值。这种视角被称为<strong>场视角</strong>或<strong>欧拉视角 (Eulerian Viewpoint)</strong>。
</p>
<p>
尽管<strong>场视角</strong>在实际应用中更有用，但<strong>物质描述</strong>在推导方程和获得见解方面经常提供重要帮助。这是因为从<strong>基本观点</strong>来看，重要的量往往与给定流体微团相关。这些量直接出现在牛顿运动定律和热力学方程中。
</p>

<h3>1.1.2 流体性质的物质导数</h3>

<p>
一个<strong>流体微团</strong>是一个无限小、不可分割的流体单元——实际上是一个<strong>固定质量</strong>的非常小的流体包。<strong>物质导数 (Material Derivative)</strong> 或<strong>拉格朗日导数 (Lagrangian Derivative)</strong>，是描述一个特性（如温度或动量）在单个流体微团上的变化率。这相当于该特性在单个流体单元上的总时间导数。
</p>

<p>
假设一个流体由一个给定的速度场 \(\mathbf{v}(x, t)\) 描述，它决定了流体的运动。假设流体还有另一个性质 \(\varphi\)，我们来推导 \(\varphi\) 在时间和空间中变化的表达式。根据<strong>链式法则</strong>，我们有：
</p>

<div class="formula">
\[
\delta \varphi = \frac{\partial \varphi}{\partial t} \delta t + \frac{\partial \varphi}{\partial x} \delta x + \frac{\partial \varphi}{\partial y} \delta y + \frac{\partial \varphi}{\partial z} \delta z = \frac{\partial \varphi}{\partial t} \delta t + \delta x \cdot \nabla \varphi.
\]
</div>

<p>
这对任何 \(\delta t\)、\(\delta x\) 等都成立。因此，总时间导数为：
</p>

<div class="formula">
\[
\frac{d \varphi}{dt} = \frac{\partial \varphi}{\partial t} + \mathbf{v} \cdot \nabla \varphi.
\]
</div>

<p>
如果这个方程要表示<strong>物质导数</strong>，我们必须将右侧第二项中的时间导数识别为流体微团的位置变化率，即其<strong>速度</strong>。因此，\(\varphi\) 的物质导数为：
</p>

<div class="formula">
\[
\frac{D \varphi}{Dt} = \frac{\partial \varphi}{\partial t} + (\mathbf{v} \cdot \nabla) \varphi.
\]
</div>

<p>
右侧表示了<strong>物质导数</strong>，它包括了<strong>局部变化率</strong>（\(\partial \varphi / \partial t\)）以及因流体微团的移动而引起的空间变化率（\(\mathbf{v} \cdot \nabla \varphi\)）。
</p>

<p>
由于<strong>物质导数</strong>在流体动力学中非常常见，为了与其他导数区分，我们用算子 \(\frac{D}{Dt}\) 来表示。因此，场的<strong>物质导数</strong>为：
</p>

<div class="formula">
\[
\frac{D \varphi}{Dt} = \frac{\partial \varphi}{\partial t} + (\mathbf{v} \cdot \nabla) \varphi.
\]
</div>

<p class="note">
该方程中最后一项的括号有助于提醒我们，\((\mathbf{v} \cdot \nabla)\) 是一个作用于 \(\varphi\) 的算子。算子 \(\partial / \partial t + (\mathbf{v} \cdot \nabla)\) 是<strong>拉格朗日导数在场的欧拉表示</strong>。
</p>

<h2>备注</h2>
<ul>
    <li><strong>拉格朗日视角</strong>得名于法意数学家<strong>约瑟夫·拉格朗日 (1736–1813)</strong>。</li>
    <li><strong>欧拉视角</strong>得名于瑞士数学家<strong>莱昂哈德·欧拉 (1707–1783)</strong>。</li>
</ul>

</body>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>流体动力学时间导数</title>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'SimSun', serif;
            line-height: 1.8;
            margin: 20px;
        }
        h1, h2, h3 {
            text-align: center;
            margin-top: 30px;
        }
        p {
            text-indent: 2em;
        }
        .formula {
            text-align: center;
            margin: 20px 0;
        }
        .note {
            font-style: italic;
            color: gray;
        }
        ul {
            margin-left: 2em;
        }
        li {
            margin-bottom: 0.5em;
        }
    </style>
</head>
<body>


<h4>矢量场的物质导数</h4>

<p>
物质导数可以作用于一个<strong>矢量场 \( b \)</strong>，在这种情况下，有以下表达式：
</p>

<div class="formula">
\[
\frac{D b}{D t} = \frac{\partial b}{\partial t} + (\mathbf{v} \cdot \nabla) b.
\]
</div>

<p>
在<strong>笛卡尔坐标系</strong>中，这个方程可以写成：
</p>

<div class="formula">
\[
\frac{D b}{D t} = \frac{\partial b}{\partial t} + u \frac{\partial b}{\partial x} + v \frac{\partial b}{\partial y} + w \frac{\partial b}{\partial z}.
\]
</div>

<p>
对于矢量场 \( b \) 的特定分量 \( b^x \)，我们有：
</p>

<div class="formula">
\[
\frac{D b^x}{D t} = \frac{\partial b^x}{\partial t} + u \frac{\partial b^x}{\partial x} + v \frac{\partial b^x}{\partial y} + w \frac{\partial b^x}{\partial z}.
\]
</div>

<p>
对于 \( b^y \) 和 \( b^z \) 的分量，也有类似的表达式。在非笛卡尔坐标系中，矢量的对流导数不仅仅是其各个分量的对流导数之和，因为坐标矢量本身的位置变化会引起方向的改变。这一点在我们处理<strong>球坐标系</strong>时将变得重要。
</p>
<h3>1.1.3 体积的物质导数 (Material Derivative of a Volume)</h3>
<p>
当一个具有不变质量的流体单元的体积受到流体运动的变形和平流影响时，没有理由认为其体积应保持不变。相反，体积将随着其边界物质表面上每个元素的移动而发生变化，特别是当流体表面法向速度分量不为零时，体积将发生变化。也就是说，如果某些流体的体积为 \( \int dV \)，那么：
</p>

<p>
\[
\frac{D}{Dt} \int_V dV = \int_S \mathbf{v} \cdot d\mathbf{s}, \quad (1.8)
\]
</p>

<p>
其中，下标 \( V \) 表示积分是针对某个有限体积 \( V \) 进行的，积分的限值是时间的函数，因为体积在变化。右侧的积分是针对包围该体积的封闭表面 \( S \) 进行的。虽然这个表达式在直觉上很明显（对某些人来说），但它可以通过莱布尼茨公式（Leibniz's Formula）更正式地推导出来，莱布尼茨公式用于积分限随时间变化的情况。利用散度定理，右侧的积分可转换为：
</p>

<p>
\[
\frac{D}{Dt} \int_V dV = \int_V \nabla \cdot \mathbf{v} \, dV. \quad (1.9)
\]
</p>

<p>
一个无限小流体单元的体积变化率是通过将上述表达式取体积趋于零的极限而得到的，表示为：
</p>

<p>
\[
\lim_{\Delta V \to 0} \frac{1}{\Delta V} \frac{D (\Delta V)}{Dt} = \nabla \cdot \mathbf{v}. \quad (1.10)
\]
</p>

<p>我们经常将这样的表达式非正式地写成：</p>
<p>
$$
\frac{D (\Delta V)}{D t} = \Delta V \nabla \cdot \mathbf{v},\quad (1.11
$$
</p>
<p>其中极限是隐含的。</p>

<p>现在考虑某种流体特性 ξ（例如单位体积 ξ-物质的量——质量密度或单位体积染料的量）与流体单元体积 ΔV 的乘积的物质导数。这种导数在 ξ 是单位体积 ξ-物质的量时产生。我们有：</p>
<p>
$$
\frac{D (\xi \Delta V)}{D t} = \xi \frac{D (\Delta V)}{D t} + \Delta V \frac{D \xi}{D t}.\quad (1.12)
$$
</p>

<p>使用 (1.11) 式，这个表达式变为：</p>
<p>
$$
\frac{D (\xi \Delta V)}{D t} = \Delta V \left( \xi \nabla \cdot \mathbf{v} + \frac{D \xi}{D t} \right).\quad (1.13)
$$
</p>


<p>对于有限体积，类似的结果可以写为：</p>
<p>
$$
\frac{D}{D t} \int_V \xi dV = \int_V \left( \xi \nabla \cdot \mathbf{v} + \frac{D \xi}{D t} \right) dV.\quad (1.14)
$$
</p>
<p>这个表达式与欧拉导数形成对比，在欧拉导数中，积分的体积是固定的，积分的极限也是固定的。</p>

<p>对于欧拉导数，我们有：</p>
<p>
$$
\frac{d}{d t} \int_V \xi dV = \int_V \frac{\partial \xi}{\partial t} dV.\quad (1.15)
$$
</p>

<p>现在考虑流体性质 φ 的物质导数，该性质由流体单元的质量 ρΔV 加权，其中 ρ 是流体密度。这样一个导数在 φ 是单位质量 φ-物质的量时产生（例如，流体单元的动量是 ρuΔV）。φρΔV 的物质导数为：</p>
<p>
$$
\frac{D (\varphi \rho \Delta V)}{D t} = \rho \Delta V \frac{D \varphi}{D t} + \varphi \frac{D (\rho \Delta V)}{D t}.\quad (1.16)
$$
</p>

<p>但 ρΔV 只是流体单元的质量，这是一个常量——这是如何定义流体单元的。因此，右侧的第二项消失，化简为：</p>
<p>
$$
\frac{D (\varphi \rho \Delta V)}{D t} = \rho \Delta V \frac{D \varphi}{D t}.\quad (1.17)
$$
</p>

<p>对于有限体积，有以下关系：</p>
<p>
$$
\frac{D}{D t} \int_V \varphi \rho dV = \int_V \rho \frac{D \varphi}{D t} dV.\quad (1.18)
$$
</p>

<p>该表达式也可以更正式地使用**莱布尼茨公式**推导出来，对于物质导数的积分形式，结果也适用于当 φ 是一个矢量时。在欧拉导数的情况下，体积保持固定，我们有：</p>
<p>
$$
\frac{d}{d t} \int_V \varphi \rho dV = \int_V \frac{\partial (\varphi \rho)}{\partial t} dV.\quad (1.19)
$$
</p>

<p>在相邻页面的阴影框中，总结了各种物质导数和欧拉导数。</p>
<h3>物质导数与欧拉导数 (Material and Eulerian Derivatives)</h3>
<p>
标量 \( \phi \) 和矢量场 \( \mathbf{b} \) 的物质导数分别为：
</p>

<p>
\[
\frac{D \phi}{Dt} = \frac{\partial \phi}{\partial t} + \mathbf{v} \cdot \nabla \phi, \quad \frac{D \mathbf{b}}{Dt} = \frac{\partial \mathbf{b}}{\partial t} + (\mathbf{v} \cdot \nabla) \mathbf{b}. \quad (D.1)
\]
</p>

<p>
各种积分形式的物质导数为：
</p>

<p>
\[
\frac{D}{Dt} \int_V \phi \, dV = \int_V \left(\frac{D \phi}{Dt} + \phi \nabla \cdot \mathbf{v}\right) \, dV = \int_V \left(\frac{\partial \phi}{\partial t} + \nabla \cdot (\phi \mathbf{v})\right) \, dV, \quad (D.2)
\]
</p>

<p>
\[
\frac{D}{Dt} \int_V dV = \int_V \nabla \cdot \mathbf{v} \, dV, \quad (D.3)
\]
</p>

<p>
\[
\frac{D}{Dt} \int_V \rho \phi \, dV = \int_V \rho \frac{D \phi}{Dt} \, dV. \quad (D.4)
\]
</p>

<p>
这些公式在 \( \phi \) 是一个矢量的情况下同样成立。积分的欧拉导数为：
</p>

<p>
\[
\frac{d}{dt} \int_V \phi \, dV = \int_V \frac{\partial \phi}{\partial t} \, dV, \quad (D.5)
\]
</p>

<p>
因此：
</p>

<p>
\[
\frac{d}{dt} \int_V dV = 0, \quad \frac{d}{dt} \int_V \rho \phi \, dV = \int_V \frac{\partial (\rho \phi)}{\partial t} \, dV. \quad (D.6)
\]
</p>
<h2>1.2 质量连续性方程</h2>

<p>
在经典力学中，质量是绝对守恒的，而在固体力学中，我们通常不需要显式的质量守恒方程。然而，在流体力学中，流体可能会流入或流出某个特定位置，并且流体的密度可能会发生变化，因此我们需要一个方程来描述这种变化。
</p>

<h3>1.2.1 欧拉推导</h3>

<p>
我们首先从欧拉视角推导质量守恒方程，也就是说，我们的参考系固定在空间中，流体通过这个参考系流动。考虑一个无限小的、固定在空间中的长方体控制体积，体积为：
</p>

<p>
\[
\Delta V = \Delta x \Delta y \Delta z
\]
</p>

<p>
如图1.1所示。流体通过其表面流入或流出体积，包括通过在 \(y-z\) 平面上的面，面积为：
</p>

<p>
\[
\Delta A = \Delta y \Delta z
\]
</p>

<p>
坐标在 \(x\) 和 \(x + \Delta x\) 之间。由于流体在 \(x\) 方向的运动，控制体积内的流体积累量是：
</p>

<p>
\[
\Delta y \Delta z \left[\rho u(x,y,z) - \rho u(x+\Delta x,y,z)\right] = -\frac{\partial (\rho u)}{\partial x} \Delta x \Delta y \Delta z
\]
</p>

<p>
显然，还必须加上在 \(y\) 和 \(z\) 方向的运动效应，即：
</p>

<p>
\[
-\left[\frac{\partial (\rho v)}{\partial y} + \frac{\partial (\rho w)}{\partial z}\right] \Delta x \Delta y \Delta z
\]
</p>

<p>
这种流体的净积累必须伴随着控制体积内流体质量的相应增加。这表示为：
</p>

<p>
\[
\frac{\partial}{\partial t} (\text{密度} \times \text{体积}) = \Delta x \Delta y \Delta z \frac{\partial \rho}{\partial t}
\]
</p>

<p>
由于体积是常数，因此，由质量守恒，方程 (1.19) 和 (1.21) 给出：
</p>

<p>
\[
\Delta x \Delta y \Delta z \left[\frac{\partial \rho}{\partial t} + \frac{\partial (\rho u)}{\partial x} + \frac{\partial (\rho v)}{\partial y} + \frac{\partial (\rho w)}{\partial z}\right] = 0
\]
</p>

<p>
方括号中的量必须为零，因此我们得到：
</p>

<p>
\[
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0
\]
</p>

<p>
这被称为<strong>质量连续性方程</strong>，因为它认识到流体中质量场的连续性质。在方程 (1.23) 中没有扩散项，也没有像 \(\kappa \nabla^2 \rho\) 这样的项。这是因为质量是由分子宏观运动传输的；即使这种运动看起来像扩散，任何宏观的分子运动本质上构成了一个速度场。
</p>

<p>
方程 (1.23) 及其推导与笛卡尔几何无关，更一般的向量推导可以使用任意控制体积完成，这留给读者作为练习。
</p>

<h3>1.2.2 使用物质导数的质量连续性</h3>

<p>
我们现在从物质视角推导质量连续性方程 (1.23)。这是所有质量守恒方法中最基础的一个，因为质量守恒的原理简单地指出，给定流体元素的质量是守恒的。
</p>

<p>
考虑一个密度为 \(\rho\)、体积为 \(\Delta V\) 的小质量流体单元。则质量守恒可以表示为：
</p>

<p>
\[
\frac{D}{Dt} (\rho \Delta V) = 0
\]
</p>

<p>
密度和体积可能会随时间变化，因此：
</p>

<p>
\[
\Delta V \frac{D \rho}{Dt} + \frac{D (\Delta V)}{Dt} = \Delta V \left(\frac{D \rho}{Dt} + \rho \nabla \cdot \mathbf{v}\right) = 0
\]
</p>

<p>
由于体积元不为零，括号内的项必须消失，因此得到：
</p>

<p>
\[
\frac{D \rho}{Dt} + \rho \nabla \cdot \mathbf{v} = 0
\]
</p>

<p>在展开第一项后，这个结果与(1.23)完全相同。(一种稍微更正式的推导方式是使用(1.14)，将ξ替换为ρ。)</p>
<p>总结起来，表示质量守恒的等效偏微分方程为：</p>

<p>
$$
\frac{D \rho}{D t} + \rho \nabla \cdot \mathbf{v} = 0,
$$
</p>

<p>
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0.
$$
</p>

<p>(1.27a, b)</p>


<h3>1.2.3 不可压缩流体</h3>

<p>
液体的一个几乎普遍的特性是它们的密度几乎是常数，即，它们本质上是不可压缩的。如果我们将密度写成：
</p>

<p>
\[
\rho(x,y,z,t) = \rho_0 + \delta \rho(x,y,z,t)
\]
</p>

<p>
其中 \(\rho_0\) 是常数，则真正不可压缩的流体有 \(\delta \rho = 0\)。在严格意义上没有流体是不可压缩的，因此我们稍微放宽这个含义，只需满足 \(|\delta \rho| \ll \rho_0\)。当满足这一条件时，质量连续性方程 (1.27a) 变为：
</p>

<p>
\[
\frac{D \delta \rho}{Dt} + (\rho_0 + \delta \rho) \nabla \cdot \mathbf{v} = 0
\]
</p>

<p>
如果流体是不可压缩的，则涉及 \(\delta \rho\) 的项远小于涉及 \(\rho_0\) 的项，因此可以忽略，得到：
</p>

<p>
\[
\nabla \cdot \mathbf{v} = 0
\]
</p>

<p>
这就是不可压缩流体的质量连续性方程，满足这个方程可以被视为不可压缩流体的定义特性。
</p>

<h2>1.3 动量方程</h2>
<p>
动量方程是一个偏微分方程，用于描述流体单元响应于内力和外力的速度或动量变化。在本书中，我们将单独处理表示压力和粘性力的项。
</p>
<h3>1.3.1 平流 (Advection)</h3>
<p>
设 \( m(x, y, z, t) \) 表示流体的动量密度场（每单位体积的动量）。因此，\( m = \rho v \)，一个体积为 \( V \) 的流体的总动量由体积分 
\( \int_V m \, dV \) 给出。现在，对于一个流体，某个可识别流体质量的动量变化率由物质导数给出，根据牛顿第二定律，这等于作用在其上的力。因此：
</p>

<p>
\[
\frac{D}{Dt} \int_V \rho v \, dV = \int_V F \, dV, \quad (1.31)
\]
</p>

<p>
其中 \( F \) 是单位体积上的力。现在，使用方程 (1.17b)（将 \( \varphi \) 替换为 \( v \)），将(1.31)左侧转换，我们得到：
</p>

<p>
\[
\int_V \left(\rho \frac{D v}{Dt} - F\right) dV = 0. \quad (1.32)
\]
</p>

<p>
由于体积是任意的，积分项本身必须为零，因此我们得到：
</p>

<p>
\[
\rho \frac{D v}{Dt} = F \quad \text{或} \quad \frac{\partial v}{\partial t} + (v \cdot \nabla)v = \frac{F}{\rho}, \quad (1.33a,b)
\]
</p>

<p>
使用方程 (1.5) 展开物质导数，我们得到了一个关于流体在已知力作用下如何加速的表达式。除了外部力（如重力）外，由流体微团之间直接接触产生的应力还会引起压力和黏性力，这些力有时被称为 <strong>接触力 (contact forces)</strong>。
</p>
<h3>1.3.2 压力与粘性力</h3>

<h4><i>压力</i></h4>
<p>
在流体内部或边界处，压力是由分子运动的集体作用在单位面积上产生的法向力。因此：
</p>

<p>
\[
d\vec{F_p} = -p \, dS, \quad (1.34)
\]
</p>

<p>
其中，\( p \) 是压力，\( \vec{F_p} \) 是压力力，\( dS \) 是一个无限小的表面元。
如果我们接受这个直观概念，那么评估压力对流体的影响就变得简单了。因为流体上的压力力是压力在其边界上的积分，所以我们有：
</p>

<p>
\[
\vec{F_p} = - \int_S p \, dS. \quad (1.35)
\]
</p>



<h4><i>粘性</i></h4>
<p>
粘性效应在许多情况下是显而易见的，例如糖浆或火山熔岩的流动。单位体积上的粘性力大致等于 \( \mu \nabla^2 \mathbf{v} \)，其中 \( \mu \) 是粘性系数。
</p>

<p>
结合压力和粘性项，动量方程变为：
</p>

<p>
\[
\frac{\partial \mathbf{v}}{\partial t} + (\mathbf{v} \cdot \nabla) \mathbf{v} = -\frac{1}{\rho} \nabla p + \nu \nabla^2 \mathbf{v} + \mathbf{F_b}, \quad (1.37)
\]
</p>

<p>
其中，\( \nu = \frac{\mu}{\rho} \) 是运动粘性系数，\( \mathbf{F_b} \) 表示体积力（单位质量的力），例如重力 \( g \)。
在大多数大尺度大气和海洋流动中，粘性项实际上可以忽略不计。
</p>

<blockquote>
<p>
方程 (1.37) 有时被称为纳维-斯托克斯方程。如果忽略粘性项，则该方程变为欧拉方程。有时，这些名称被用来指代完整的运动方程组。
</p>
</blockquote>


<h3>1.3.3 静力近似 (The Hydrostatic Approximation)</h3>
<p>
在忽略粘性力的情况下，动量方程在垂直方向（与重力平行方向）可以写成：
</p>
<p>
\[
\frac{Dw}{Dt} = -\frac{1}{\rho} \frac{\partial p}{\partial z} - g
\]
</p>
<p>
其中，\( w \) 是速度在垂直方向的分量，\( g = -g \mathbf{k} \) 是重力加速度。如果流体处于静止状态，重力项与压力项平衡，得到：
</p>
<p>
\[
\frac{\partial p}{\partial z} = -\rho g
\]
</p>
<p>
这个关系称为**静力平衡**（或静水压力平衡）。在这种情况下，某一点的压力由其上方流体的重量确定，假设顶部压力为零：
</p>
<p>
\[
p = \int_z^\infty \rho g \, dz
\]
</p>
<p>
静水压力平衡是一个很好的近似，尤其适用于大尺度的水平流动。对于大气和海洋，除了强风暴情况下，这种近似几乎总是成立。水平动量方程中的压力项在这种近似下能够提供足够的精度，以确定水平压力梯度。
</p>
<p>
更多内容将在第3.2节中详细讨论。
</p>


<h3>表 1.1: 理想气体理论中使用的各种热力学参数</h3>
<p>
表格中列出了理想气体理论中使用的各种热力学参数，具体数值适用于干燥空气。
</p>

<table border="1" cellspacing="0" cellpadding="5">
  <thead>
    <tr>
      <th>符号 (Symbol)</th>
      <th>描述 (Description)</th>
      <th>数值 (Value)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>\( k_B \)</td>
      <td>玻尔兹曼常数 (Boltzmann constant)</td>
      <td>\( 1.38 \times 10^{-23} \, \mathrm{J \, K^{-1}} \)</td>
    </tr>
    <tr>
      <td>\( N_A \)</td>
      <td>阿伏伽德罗常数 (Avogadro constant)</td>
      <td>\( 6.02214076 \times 10^{23} \, \mathrm{mol^{-1}} \)</td>
    </tr>
    <tr>
      <td>\( R^* \)</td>
      <td>通用气体常数 (Universal gas constant = \( k_B N_A \))</td>
      <td>\( 8.31 \, \mathrm{J \, K^{-1} \, mol^{-1}} \)</td>
    </tr>
    <tr>
      <td>\( \mu \)</td>
      <td>干燥空气的摩尔质量 (Molar mass of dry air)</td>
      <td>\( 29 \times 10^{-3} \, \mathrm{kg \, mol^{-1}} \)</td>
    </tr>
    <tr>
      <td>\( R \)</td>
      <td>比气体常数 (Specific gas constant = \( R^* / \mu \))</td>
      <td>\( 287 \, \mathrm{J \, kg^{-1} \, K^{-1}} \)</td>
    </tr>
    <tr>
      <td>\( c_v \)</td>
      <td>定容热容 (Specific heat capacity at constant volume)</td>
      <td>\( 717 \, \mathrm{J \, kg^{-1} \, K^{-1}} \)</td>
    </tr>
    <tr>
      <td>\( c_p \)</td>
      <td>定压热容 (Specific heat capacity at constant pressure)</td>
      <td>\( 1004 \, \mathrm{J \, kg^{-1} \, K^{-1}} \)</td>
    </tr>
    <tr>
      <td>\( c_s \)</td>
      <td>声速 (Sound speed at \( T = 273 \, \mathrm{K} \))</td>
      <td>\( 331 \, \mathrm{m \, s^{-1}} \)</td>
    </tr>
  </tbody>
</table>
<h2>1.4 状态方程</h2>
<p>在三维空间中，动量方程和连续性方程提供了四个方程，但包含五个未知数——速度的三个分量、密度和压力。因此，显然还需要其他方程。<em>状态方程</em>是一个诊断性方程，它将不同的热力学变量相互联系起来。最常见的是状态方程以温度、密度、压力和成分的形式书写，这种方程被称为<em>热力学状态方程</em>，它因流体的不同而有所不同。在本书中，我们将主要讨论与理想气体（如大气）或海水（如海洋）有关的方程。海水的成分会随着水蒸气含量而略有变化，海水的成分也会随着盐度而略有变化。</p>

<h3>1.4.1 理想气体</h3>
<p>对于恒定成分的理想气体，状态方程通常写成：</p>
<p>$$ pV = Nk_B T = nR^* T, \quad (1.40) $$</p>
<p>其中，\( k_B \) 是玻尔兹曼常数，\( N \) 是体积 \( V \) 中的分子总数，\( R^* \) 是普适气体常数，\( n \) 是体积内的摩尔数，其中一摩尔是包含阿伏伽德罗常数个基本单元的物质量。方程右侧的两个表达式是等价的，因为 \( N = n N_A \) 且 \( R^* = k_B N_A \)，其中 \( N_A \) 是阿伏伽德罗常数（见表 1.1 及边注）。</p>
<p>对于流体动力学目的，我们将方程 (1.40) 除以总质量 \( M = n \mu \)，其中 \( \mu \) 是摩尔质量（每摩尔的质量，通常也称为气体的分子量），得到：</p>
<p>$$ p = \rho R T. \quad (1.41) $$</p>
<p>其中 \( R = R^* / \mu \) 是<em>比气体常数</em>，它随物质而变化。对于干空气，\( R = 287 \, \text{J} \, \text{kg}^{-1} \, \text{K}^{-1} \)。空气的成分几乎保持恒定，除非水蒸气含量发生变化；这些变化使得 \( R \) 成为水蒸气含量的弱函数，但在流体动力学中我们将 \( R \) 视为常数。最后，在流体动力学中，通常使用密度的倒数来表示特定体积，即 \( \alpha = 1 / \rho \)，因此状态方程可以写成：</p>
<p>$$ p \alpha = R T. $$</p>

<h3>1.4.2 海水</h3>
<p>水几乎是不可压缩的：其密度随温度、盐度或压力的变化非常小。然而，这些微小的变化在海洋学中非常重要，因为它们使海洋能够在大洋环流和深海洋流中传输大量的热量。没有一个简单的状态方程可以精确描述海水，但在许多情况下，我们可以将其近似为：</p>
<p>$$ \rho = \rho_0 [1 - \beta_T (T - T_0) + \beta_S (S - S_0) + \beta_p (P - P_0)], \quad (1.42) $$</p>
<p>其中，\( \beta_T \)、\( \beta_S \) 和 \( \beta_p \) 是经验参数，\( S_0 \)、\( T_0 \) 和 \( P_0 \) 是常数，通常我们取 \( P_0 = 0 \)。（对于定量海洋学，仍需要更精确的方程。）这些参数的典型值在表 1.2 中给出。参数 \( \beta_p \) 与声速 \( c_s \) 有关，\( c_s \) 由 \( c_s^2 = (\partial p / \partial \rho) \) 给出。利用此结果和方程 (1.42) 可得一个很好的近似值，\( \beta_p = 1 / \rho_0 c_s^2 \)，且 \( c_s = 1500 \, \text{m} \, \text{s}^{-1} \)。在 (1.42) 中，没有一个项会导致海洋密度的较大变化。</p>
<p>不幸的是（或者说幸运的是），状态方程将另一个未知数（温度）引入到我们的方程组中。因此，我们必须引入另一个物理原理——来自热力学的原理——以获得完整的方程组，如我们将在接下来探讨的那样。</p>

<h4>表 1.2：适用于海水的热力学和状态方程参数</h4>
<table>
  <tr>
    <th>符号</th>
    <th>描述</th>
    <th>数值</th>
  </tr>
  <tr>
    <td>\( \rho_0 \)</td>
    <td>参考密度</td>
    <td>\( 1.027 \times 10^3 \, \text{kg} \, \text{m}^{-3} \)</td>
  </tr>
  <tr>
    <td>\( \alpha_0 \)</td>
    <td>参考比体积</td>
    <td>\( 9.738 \times 10^{-4} \, \text{m}^3 \, \text{kg}^{-1} \)</td>
  </tr>
  <tr>
    <td>\( T_0 \)</td>
    <td>参考温度</td>
    <td>\( 283 \, \text{K} \)</td>
  </tr>
  <tr>
    <td>\( S_0 \)</td>
    <td>参考盐度</td>
    <td>\( 35 \, \text{ppt} \)</td>
  </tr>
  <tr>
    <td>\( c_s \)</td>
    <td>参考声速</td>
    <td>\( 1490 \, \text{m/s} \)</td>
  </tr>
  <tr>
    <td>\( \beta_T \)</td>
    <td>热膨胀系数</td>
    <td>\( 1.67 \times 10^{-4} \, \text{K}^{-1} \)</td>
  </tr>
  <tr>
    <td>\( \beta_S \)</td>
    <td>盐度收缩系数</td>
    <td>\( 0.78 \times 10^{-3} \, \text{ppt}^{-1} \)</td>
  </tr>
  <tr>
    <td>\( c_p \)</td>
    <td>定压比热容</td>
    <td>\( 3986 \, \text{J} \, \text{kg}^{-1} \, \text{K}^{-1} \)</td>
  </tr>
</table>
    <h2>1.5 热力学 (Thermodynamics)</h2>

    <h3>1.5.1 一些基本原理 (A Few Fundamentals)</h3>
    <p>
        <em>热力学第一定律</em>指出，物体的内能 <em>I</em> 可能因为其所做或外界对其所做的功、热量的输入，或者其化学成分的变化而发生改变。我们将忽略最后一种效应，因此有：
    </p>
    <p>
        \[
        dI = dQ + dW, \quad (1.43)
        \]
    </p>
    <p>
        其中 \( dW \) 是对物体所做的功，\( dQ \) 是输入物体的热量，我们将所有这些量视为每单位质量的量。(例如，当物体被压缩时会产生热量)。热量传导会导致功的发生（以 \( d \) 表示的不完全微分量）。右侧的量不是状态变量，而是微小量。\( Q \) 和 \( W \) 不能被看作是“热量”和“功”的总和，因为它们不是状态函数，而是能量的通量或输入率。
    </p>
    <p>
        然而，热量输入和所做的功可以与状态变量联系起来，如下所示：
    </p>

    <h4>热量输入 (Heat Input)</h4>
    <p>
        尽管热量本身不是状态函数，但存在一个直接响应热传递的状态函数，即熵 (entropy)。具体来说，在一个准静态或可逆过程中，如果向系统输入一微小量的热量 \( dQ \)，则单位质量的熵 \( \eta \) 将根据以下公式变化：
    </p>
    <p>
        \[
        T d\eta = dQ. \quad (1.44)
        \]
    </p>
    <p>
        换句话说，熵的变化等于热量输入与温度之比。
    </p>

    <h4>功的作用 (Work Done)</h4>
    <p>
        在可逆过程中，对物体所做的功等于压力与体积变化的乘积。如果功是正的，则体积变化是负的。因此，如果对物体施加一个微小的功 \( dW \)，其热力学状态将根据以下公式变化：
    </p>
    <p>
        \[
        -p d\alpha = dW, \quad (1.45)
        \]
    </p>
    <p>
        其中 \( \alpha = \frac{1}{\rho} \) 是流体的比体积，\( p \) 是压力。
    </p>
    <p>
        将公式 (1.43)–(1.45) 结合起来，我们得到：
    </p>
    <p>
        \[
        dI = T d\eta - p d\alpha. \quad (1.46)
        \]
    </p>
    <p>
        这个表达式被称为 <strong>基本热力学关系</strong>，下面我们将看看它如何应用于流体。
    </p>

    <h3>1.5.2 流体的热力学方程 (Thermodynamic Equation for a Fluid)</h3>
    <p>
        假设流体的加热来自外部因素，例如来自太阳的辐射，并且密度和内能的变化是这种加热的结果。那么可以写成：
    </p>
    <p>
        \[
        dI + p d\alpha = dQ. \quad (1.47)
        \]
    </p>
    <p>
        这个方程适用于特定的流体单元，而不是特定位置。内能和体积的变化率由物质导数给出：
    </p>
    <p>
        \[
        \frac{DI}{Dt} - \frac{p}{\rho^2} \frac{D\rho}{Dt} = \dot{Q}. \quad (1.48)
        \]
    </p>
    <p>
        其中 \( \dot{Q} \) 是单位时间的热量输入率。利用质量守恒方程，我们可以将密度的时间导数重新写成：
    </p>
    <p>
        \[
        \frac{DI}{Dt} + \frac{p}{\rho} \nabla \cdot v = \dot{Q}. \quad (1.49)
        \]
    </p>
    <p>
        这是流体的 <strong>热力学方程</strong>，它告诉我们内能如何响应加热。
    </p>

    <h4>理想气体 (An Ideal Gas)</h4>
    <p>
        在理想气体中，内能仅是温度的函数，表达式为：
    </p>
    <p>
        \[
        I = c_v T, \quad (1.50)
        \]
    </p>
    <p>
        其中 \( c_v \) 是恒定体积下的热容。对于地球大气中的气体，\( c_v \) 近似为常数。因此，方程 (1.49) 变为：
    </p>
    <p>
        \[
        c_v \frac{DT}{Dt} + \frac{p}{\rho} \nabla \cdot v = \dot{Q}. \quad (1.51)
        \]
    </p>
    <p>
        方程 (1.51) 可能是大气科学中最常用的热力学方程形式。
    </p>
    <p>
        我们可以将方程 (1.47) 重写为：
    </p>
    <p>
        \[
        dI + d(\alpha p) - \alpha dp = dQ \quad \text{或} \quad d(c_v T) + d(RT) - \alpha dp = dQ, \quad (1.52a,b)
        \]
    </p>
    <p>
        第二个表达式适用于理想气体。我们令 \( c_p = c_v + R \)，则方程 (1.52b) 对于恒定的 \( c_p \) 变为：
    </p>
    <p>
        \[
        c_p dT - \alpha dp = dQ \quad \Rightarrow \quad c_p \frac{DT}{Dt} - \alpha \frac{Dp}{Dt} = \dot{Q}, \quad (1.53a,b)
        \]
    </p>
    <p>
        从 (1.53a) 可以看出，\( c_p \) 就是恒定压力下的热容。方程 (1.53b) 等价于 (1.51)，尽管可能没有那么广泛地使用。
    </p>
    <p>
        流体的完整运动方程将在下一页中总结。
    </p>
    <p>
        在理想气体中，\( c_p \)、\( c_v \) 和 \( R \) 仅是温度的函数，它们之间的关系为：
    </p>
    <p>
        \[
        c_p - c_v = R.
        \]
    </p>
    <p>
        在地球大气中，这些参数实际上几乎是常数。
    </p>
        <h2>1.6 势温与熵 (Potential Temperature and Entropy)</h2>
    <p>
        当流体被加热时，其熵增加，遵循以下关系：
    </p>
    <p>
        \[
        T d\eta = dQ \quad \text{如式} (1.44).
        \]
    </p>
    <p>
        对其进行物质导数，得到：
    </p>
    <p>
        \[
        T \frac{D \eta}{D t} = \dot{Q}. \quad (1.54)
        \]
    </p>
    <div class="abstract">
    <h2>流体的运动方程 (The Equations of Motion for a Fluid)</h2>
    
    <h3>动量方程 (The Momentum Equation)</h3>
    <p>
        动量方程是关于速度的演化方程，体现了牛顿第二定律，即力等于质量乘以加速度。其表达式为：
    </p>
    <p>
        \[
        \frac{D \mathbf{v}}{D t} = -\frac{1}{\rho} \nabla p + \mathbf{v} \cdot \nabla \mathbf{v} + \mathbf{g}, \quad (F.1)
        \]
    </p>
    <p>
        其中，\( \mathbf{g} \) 是单位质量的重力。
    </p>

    <h3>质量连续性方程 (The Mass Continuity Equation)</h3>
    <p>
        质量连续性方程体现了质量守恒原理。两种等效形式为：
    </p>
    <p>
        \[
        \frac{D \rho}{D t} + \rho \nabla \cdot \mathbf{v} = 0, \quad \frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{v}) = 0. \quad (F.2)
        \]
    </p>
    <p>
        如果流体是不可压缩的，上述方程变为：
    </p>
    <p>
        \[
        \nabla \cdot \mathbf{v} = 0. \quad (F.3)
        \]
    </p>

    <h3>热力学方程 (The Thermodynamic Equation)</h3>
    <p>
        热力学方程是热力学第一定律的陈述，表达为：
    </p>
    <p>
        \[
        \frac{D I}{D t} + \frac{p}{\rho} \nabla \cdot \mathbf{v} = \dot{Q}. \quad (F.4)
        \]
    </p>
    <p>
        其中，\( \dot{Q} \) 是总加热量。对于理想气体，\( I = c_v T \) 且 \( p = \rho R T \)，方程变为：
    </p>
    <p>
        \[
        \frac{D T}{D t} + \frac{R T}{c_v} \nabla \cdot \mathbf{v} = \frac{\dot{Q}}{c_v} = \kappa \nabla^2 T + J. \quad (F.5)
        \]
    </p>
    <p>
        在这里，我们将加热分为温度扩散和外部热源 \( J \)。
    </p>

    <h3>状态方程 (Equation of State)</h3>
    <p>
        状态方程是一个诊断方程，连接压力、密度、温度，以及（如果流体成分变化）组成。对于单组分理想气体，状态方程为：
    </p>
    <p>
        \[
        p = \rho R T. \quad (F.6)
        \]
    </p>
    <p>
        对于海水，一个密度关于压力、温度和盐度的近似状态方程为：
    </p>
    <p>
        \[
        \rho = \rho_0 \left[1 - \beta_T (T - T_0) + \beta_S (S - S_0) + \beta_p (p - p_0) \right]. \quad (F.7)
        \]
    </p>
    <p>
        对于定量海洋学，我们需要更精确的状态方程，并包含非线性项。
    </p>
    </div>
    <p>
        这是热力学方程的另一种形式，可以代替内部能量方程 (1.49)，但这样做涉及使用状态方程将熵与其他热力学变量联系起来，其形式为：
    </p>
    <p>
        \[
        \eta = \eta(T, p),
        \]
    </p>
    <p>
        或者，一般来说，作为压力、密度和温度的任意两个变量的函数。（熵也是组成的函数，但我们将其视为常数。）对于理想气体，我们可以得到这样的表达式，如下所示：
    </p>
    <p>
        使用理想气体的状态方程，我们可以将热力学第一定律写成两种等效的形式：
    </p>
    <p>
        \[
        c_v dT + p d\alpha = dQ, \quad c_p dT - \alpha dp = dQ. \quad (1.56a,b)
        \]
    </p>
    <p>
        然后，由于熵的增加遵循 \( T d\eta = dQ \)，我们有：
    </p>
    <p>
        \[
        c_v dT + p d\alpha = T d\eta, \quad c_p dT - \alpha dp = T d\eta. \quad (1.57a,b)
        \]
    </p>
    <p>
        这些是应用于理想气体的基本热力学关系的两种形式。使用状态方程 \( \alpha = \frac{RT}{p} \)，上述方程可以写成：
    </p>
    <p>
        \[
        \frac{dT}{T} - \frac{R}{c_v} \frac{dp}{p} = d\eta, \quad \frac{c_p}{T} dT - \frac{R}{p} dp = d\eta. \quad (1.58a,b)
        \]
    </p>
    <p>
        我们可以对(1.58)进行积分，得到理想气体熵的两个等效显式表达式：
    </p>
    <p>
        \[
        \eta = c_v \log T - R \log p + \text{常数}, \quad \eta = c_p \log T - R \log p + \text{常数}. \quad (1.59)
        \]
    </p>
    <p>
        与经典力学一样，熵包含一个任意常数。为了方便，我们现在定义一个量，\( \theta \)，称为势温(Potential Temperature)，使得：
    </p>
    <p>
        \[
        \eta = c_p \ln \theta. \quad (1.60)
        \]
    </p>
    <p>
        因此：
    </p>
    <p>
        \[
        d\eta = c_p \left(\frac{d\theta}{\theta}\right).
        \]
    </p>
    <p>
        将此表达式代入(1.57b)并积分，得到：
    </p>
    <p>
        \[
        c_p \log T - R \log p = c_p \log \theta + \text{常数}. \quad (1.61)
        \]
    </p>
    <p>
        如果我们将积分常数折叠到压力项中，这个方程可以写成：
    </p>
    <p>
        \[
        \theta = T \left(\frac{P_R}{p}\right)^{R/c_p}. \quad (1.62)
        \]
    </p>
    <p>
        其中 \( P_R \) 是一个常数。根据(1.60)，我们可以将(1.54)写成：
    </p>
    <p>
        \[
        c_p \frac{D \theta}{D t} = \frac{\theta}{T} \dot{Q}. \quad (1.63)
        \]
    </p>
    <p>
        这种形式的热力学方程等价于(1.51)，在某些方面更简单。然而，它仅对理想气体有效——对于海水来说，由于真实海水状态方程的非线性特性，以及海水的 \( c_p \) 不是常数，获得类似的表达式更为困难。
    </p>
    <blockquote>
        注意：熵直接响应热量输入，但它并不是物体热含量的度量，也没有这样的度量存在。熵的增加取决于热量加入时的温度。同样，物体也不包含一定量的功。功和加热都会改变物体的内能。
    </blockquote>
       <h3>1.6.1 势温的含义 (Meaning of Potential Temperature)</h3>
    <p>
        我们引入了<strong>势温</strong>，作为流体熵的度量，这是它最恰当的解释方式。然而，它还有一个有用的物理解释，如下所述。假设一个恒定组成的流体包裹在绝热条件下从一个位置移动到另一个位置，或者在不同的压力下移动。绝热意味着没有热量进出该流体包裹，因此：
    </p>
    <p>
        \[
        \dot{Q} = 0.
        \]
    </p>
    <p>
        在可逆过程中（例如无耗散流动），熵和势温将被守恒。然而，由于流体包裹可能被压缩或膨胀，其温度将会改变，如方程 (1.56) 所示。
    </p>
    <p>
        考虑一个初始压力为 \( P_1 \) 的流体包裹，温度为 \( T_1 \)，势温为 \( \theta_1 \)。现在将该包裹绝热地移动到压力 \( P_R \) 处。包裹的温度将改变，但其最终的势温保持不变：
    </p>
    <p>
        \[
        T_2 = \theta_1 \quad \text{当} \, P = P_R.
        \]
    </p>
    <p>
        因此，流体包裹的最终温度等于其初始势温。我们可以说：
    </p>
    <blockquote>
        <strong>流体包裹的势温是当它在绝热条件下移动到标准压力 \( P_R \) 时所获得的温度。</strong>
    </blockquote>
    <p>
        这个定义在大气科学中被广泛应用。虽然势温可以任意选择，但在大多数大气应用中，通常选择：
    </p>
    <p>
        \[
        P_R = 1000 \, \text{hPa}.
        \]
    </p>
    <p>
        因此，势温是流体在绝热条件下被带到海平面时所达到的温度。由于流体在下降过程中被压缩，其内能增加，从而导致温度升高。
    </p>

    <h3>1.6.2 势密度 (Potential Density)</h3>
    <p>
        类似于势温，<strong>势密度</strong>\( \rho_\theta \) 是流体包裹在绝热和恒定组成条件下移动到参考压力 \( P_R \) 时所具有的密度。
    </p>
    <p>
        势密度是一个有用的量，因为它衡量了流体包裹相对于对流的稳定性，无论在空气中还是水中。
    </p>

    <h4>理想气体 (Ideal Gas)</h4>
    <p>
        假设一个温度为 \( T \) 且压力为 \( p \) 的流体被移动到压力 \( P_R \)，此时温度变为势温 \( \theta \)。对于理想气体，势密度在压力 \( p \) 下的密度等于其在 \( P_R \) 下的密度：
    </p>
    <p>
        \[
        \rho_\theta = \frac{P_R}{R \theta} = \frac{P_R}{R T} \left(\frac{P}{P_R}\right)^{R/c_p} = \rho \left(\frac{P}{P_R}\right)^{R/c_p}. \quad (1.64)
        \]
    </p>

    <h4>海水 (Seawater)</h4>
    <p>
        对于海水，没有与理想气体类似的确切势密度表达式。然而，我们可以通过以下近似方法获得一个合理的表达式：
    </p>
    <p>
        首先，假设密度在参考水平附近几乎是常数，然后对密度进行泰勒展开。对于一阶近似，有：
    </p>
    <p>
        \[
        \rho(p) = \rho(P_R) + (p - P_R) \frac{\partial \rho}{\partial p}. \quad (1.65)
        \]
    </p>
    <p>
        右侧第一项是势密度，第二项的导数是声速平方的倒数。因此可以写成：
    </p>
    <p>
        \[
        \rho_\theta = \rho - \frac{1}{c^2} (p - P_R). \quad (1.66)
        \]
    </p>
    <p>
        由于声速是一个可测量的量，方程 (1.66) 是一个非常有用的势密度表达式。然而，由于声速的微小变化，该表达式在涉及较大深度变化的问题中可能不够准确。
    </p>

        <h3>1.7 能量收支 (The Energy Budget)</h3>
    <p>
        流体的总能量包括动能、势能和内能。流体的流动和压力力都会将能量从一个位置传输到另一个位置，但我们仍然期望总能量是守恒的。
    </p>
    <p>
        让我们看看能量守恒在流体中是如何体现的。
    </p>

    <h4>1.7.1 能量方程 (An Energy Equation)</h4>
    <p>
        我们从一个时间不变势能 \( \Phi \) 的无粘动量方程开始：
    </p>
    <p>
        $$
        \rho \frac{D \mathbf{v}}{D t} = -\nabla p - \rho \nabla \Phi. \quad (1.67)
        $$
    </p>
    <p>
        在均匀重力场中，\( \Phi = gz \)。对方程 (1.67) 两边取点积 \( \mathbf{v} \)，得到动能方程：
    </p>
    <p>
        $$
        \frac{1}{2} \rho \frac{D \mathbf{v}^2}{D t} = -\mathbf{v} \cdot \nabla p - \rho \mathbf{v} \cdot \nabla \Phi. \quad (1.68)
        $$
    </p>
    <p>
        对于绝热流动，内能方程为：
    </p>
    <p>
        $$
        \rho \frac{D I}{D t} = -p \nabla \cdot \mathbf{v}. \quad (1.69)
        $$
    </p>
    <p>
        最后，势能满足：
    </p>
    <p>
        $$
        \rho \frac{D \Phi}{D t} = \rho \mathbf{v} \cdot \nabla \Phi. \quad (1.70)
        $$
    </p>
     <p>
        将方程 (1.68)、(1.69) 和 (1.70) 相加，我们得到：
    </p>
    <p>
        $$
        \rho \frac{D}{D t} \left(\frac{1}{2} v^2 + I + \Phi \right) = -\nabla \cdot (\mathbf{v} p). \quad (1.71)
        $$
    </p>
    <p>
        对材料导数进行展开，并使用质量守恒方程，可以得到：
    </p>
    <p>
        $$
        \frac{\partial}{\partial t} \left[\rho \left(\frac{1}{2} v^2 + I + \Phi \right)\right] + \nabla \cdot \left[\rho \mathbf{v} \left(\frac{1}{2} v^2 + I + \Phi + \frac{p}{\rho}\right)\right] = 0. \quad (1.72)
        $$
    </p>
    <p>
        可以将其简写为：
    </p>
    <p>
        $$
        \frac{\partial E}{\partial t} + \nabla \cdot \left[\mathbf{v} (E + p)\right] = 0. \quad (1.73)
        $$
    </p>
    <p>
        其中：
    </p>
    <p>
        $$
        E = \rho \left(\frac{1}{2} v^2 + I + \Phi \right)
        $$
    </p>
    <p>
        是单位体积流体的**总能量**，包括：
    </p>
    <ul>
        <li><strong>动能</strong> (\( \rho v^2 / 2 \))</li>
        <li><strong>内能</strong> (\( \rho I \))</li>
        <li><strong>势能</strong> (\( \rho \Phi \))</li>
    </ul>
    <p>
        方程 (1.73) 是一个针对**无外力、无粘性和绝热**可压缩流体的能量方程。当对封闭区域进行积分时，能量通量项消失，意味着**总能量守恒**。
    </p>
    <p>
        然而，动能、内能和势能之间可以进行能量交换。这种交换通过**散度项** \( \nabla \cdot \mathbf{v} \) 连接动能方程 (1.68) 和内能方程 (1.69)。
    </p>
    <p>
        对于不可压缩流体，这个项消失，内能与其他能量成分解耦。这一点在第2.5节的**布辛涅斯克方程**中将变得重要。
    </p>
    <blockquote>
        能量通过速度项传输，能量通量 \( F_E = \mathbf{v}(E + p) \) 并不等于速度与能量之积。能量还通过**压力**进行传输。
    </blockquote>
    <p>
        我们可以将能量通量写为：
    </p>
    <p>
        $$
        F_E = \rho \mathbf{v} \left(\frac{1}{2} v^2 + \Phi + h \right). \quad (1.74)
        $$
    </p>
    <p>
        其中：
    </p>
    <p>
        $$
        h = I + \frac{p}{\rho}
        $$
    </p>
    <p>
        是<strong>焓 (Enthalpy)</strong>。
    </p>
    <p>
        焓描述的是由动能、势能和焓通量决定的局部能量变化率，而不是内能，因为焓考虑了**压力所做的功**。
    </p>

    <h3>伯努利定理 (Bernoulli's Theorem)</h3>
    <p>
        伯努利方程定义为：
    </p>
    <p>
        $$
        B = \left(E + \frac{p}{\rho}\right) = \left(\frac{1}{2} v^2 + I + \Phi + \frac{p}{\rho}\right) = \left(\frac{1}{2} v^2 + h + \Phi \right). \quad (1.75)
        $$
    </p>
    <p>
        在稳态流动中，伯努利函数在流线上保持不变：
    </p>
    <p>
        $$
        \frac{\partial E}{\partial t} + \nabla \cdot (\rho \mathbf{v} B) = 0. \quad (1.76)
        $$
    </p>

    <blockquote>
        伯努利函数表示为总能量与压强之和。在稳态流动中，它在流线上是常数。
    </blockquote>
    <p>
        这表明在理想条件下，动能、势能、内能和压力相互联系，并且能量在流体的不同部分之间进行交换。
    </p>
        <p>
        如果流体的密度是恒定的，推导过程与之前相同，但有一个重要的简化。速度的散度项为零，因此在动能方程的右侧 (1.68) 中，\( \nabla \cdot \mathbf{v} \) 项不会出现。
    </p>
    <p>
        内能方程的右侧 (1.69) 变为零，内能与动能之间解耦。动能方程变为：
    </p>
    <p>
        $$
        \frac{\partial K}{\partial t} + \nabla \cdot (\mathbf{v} (B)) = 0. \quad (1.78)
        $$
    </p>
    <p>
        其中：
    </p>
    <p>
        \( K = \frac{v^2}{2} \) 是动能，\( B = \Phi + \Phi + \frac{v^2}{2} \) 其中 \( \Phi = \frac{p}{\rho_0} \) 是**动力压强**。
    </p>
    <p>
        伯努利函数不包含内能，而**总动能**是守恒的。
    </p>

<h3>1.7.3 粘性效应 (Viscous Effects)</h3>

<p>我们可以预期，粘性总是会减少流体流动的动能。在这里，我们针对恒定密度流体进行了证明，该流体满足以下方程：</p>

<p>
\[
\frac{D \mathbf{v}}{D t} = -\nabla (\phi + \Phi) + \nu \nabla^2 \mathbf{v}. \quad (1.79)
\]
</p>

<p>能量方程变为：</p>

<p>
\[
\frac{d \bar{E}}{d t} = \frac{d}{d t} \int_V E \, dV = \mu \int_V \mathbf{v} \cdot \nabla^2 \mathbf{v} \, dV. \quad (1.80)
\]
</p>

<p>右侧是负定的。为了证明这一点，我们使用向量恒等式：</p>

<p>
\[
\nabla \times (\nabla \times \mathbf{v}) = \nabla (\nabla \cdot \mathbf{v}) - \nabla^2 \mathbf{v}, \quad (1.81)
\]
</p>

<p>由于 \(\nabla \cdot \mathbf{v} = 0\)，我们有：</p>

<p>
\[
\nabla^2 \mathbf{v} = -\nabla \times \mathbf{\omega}, \quad \text{其中} \, \mathbf{\omega} \equiv \nabla \times \mathbf{v}.
\]
</p>

<p>因此：</p>

<p>
\[
\frac{d \bar{E}}{d t} = -\mu \int_V \mathbf{v} \cdot (\nabla \times \mathbf{\omega}) \, dV = -\mu \int_V \mathbf{\omega} \cdot (\nabla \times \mathbf{v}) \, dV = -\mu \int_V \mathbf{\omega}^2 \, dV. \quad (1.82)
\]
</p>

<p>在进行分部积分后，假设边界上 \(\mathbf{v} \times \mathbf{\omega}\) 为零。因此，粘性通过提取流体流动的动能来起作用。动能的损失以不可逆的流体加热形式重新出现，而流体的总能量仍然是守恒的。</p>

<p>在地球大气中，这种加热效应很小，但在其他行星上可能会很大。</p>

    <h3>问题（Problems）</h3>

<h4>1.1</h4>
<p>证明积分的导数可以表示为：</p>
<p>
\[
\frac{d}{dt} \int_{x_1(t)}^{x_2(t)} \phi(x,t) dx = \int_{x_1(t)}^{x_2(t)} \frac{\partial \phi}{\partial t} dx + \frac{dx_2}{dt} \phi(x_2, t) - \frac{dx_1}{dt} \phi(x_1, t).
\]
</p>
<p>通过推广到三维空间，证明流体性质积分的物质导数表示为：</p>
<p>
\[
\frac{D}{Dt} \int_V \phi(x,t) dV = \int_V \frac{\partial \phi}{\partial t} dV + \int_S \phi \mathbf{v} \cdot dS = \int_V \left( \frac{\partial \phi}{\partial t} + \nabla \cdot (\phi \mathbf{v}) \right) dV,
\]
</p>
<p>其中表面积分 \(\int_S\) 是针对体积 \(V\) 的边界表面进行的。 因此推出：</p>
<p>
\[
\frac{D}{Dt} \int_V \rho \phi dV = \int_V \rho \frac{D\phi}{Dt} dV.
\]
</p>

<h4>1.2</h4>
<ol type="a">
    <li>
        <p>如果分子近似随机运动，为什么质量连续性方程中没有扩散项？</p>
    </li>
    <li>
        <p>假设一个流体包含干燥空气和水蒸气的二元混合物。证明由于水蒸气扩散引起的空气质量变化，正好被干燥空气向相反方向的扩散所抵消。</p>
    </li>
</ol>

<h4>1.3</h4>
<p>如果响应施加力的是动量而不是速度，为什么根据牛顿第二定律，动量方程是：</p>
<p>
\[
\rho \frac{D\mathbf{u}}{Dt} = -\nabla p
\]
</p>
<p>而不是：</p>
<p>
\[
\frac{D(\rho \mathbf{u})}{Dt} = -\nabla p？
\]
</p>

<h4>1.4</h4>
<p>使用水中热的分子扩散的观测值，估算从海洋顶部到底部通过分子扩散混合温度异常需要多长时间。假设分子扩散是唯一的热传递方式。评论在上一个冰河时代结束（约12,000年前）后，真实的海洋是否已达到平衡状态。</p>

<h4>1.5</h4>
<p>证明粘性会在可压缩流体中耗散动能。</p>

<h4>1.6</h4>
<ol type="a">
    <li>
        <p>假设一个密封的绝热容器包含两个隔室，其中一个充满理想气体，另一个是真空。隔板被移除后，气体的温度如何变化？（答案：保持不变）。请解释。</p>
    </li>
    <li>
        <p>给出最终势温的表达式，用初始气体温度和两个隔室的体积表示。</p>
    </li>
</ol>
<p>一个干燥气块在大气中绝热上升时，由于向较低压强区域移动并膨胀，它通常会冷却下来，而其势温保持不变。如何与你在(a)部分的答案保持一致？</p>
<p>将你的答案与理想气体的热力学第一定律联系起来，即：</p>
<p>
\[
dQ = T d\eta = c_p \frac{d\theta}{\theta} = dI + dW = c_v dT + p d\alpha.
\]
</p>
<p>(P1.4)</p>

<h4>1.7</h4>
<p>从简单理想气体的势温表达式开始，即 \(\theta = T (P_R / p)^\kappa\)，其中 \(\kappa = R / c_p\)，证明：</p>
<p>
\[
d\theta = \left(\frac{\theta}{T}\right)dT - \left(\frac{\alpha}{c_p}\right)dp,
\]
</p>
<p>并证明热力学第一定律可以写成：</p>
<p>
\[
dQ = T d\eta = c_p \left(\frac{T}{\theta}\right)d\theta.
\]
</p>
<p>(P1.5, P1.6)</p>

<h4>1.8</h4>
<p>证明在理想气体的绝热流动中，满足关系：</p>
<p>
\[
p p^{-\gamma} = \text{常数},
\]
</p>
<p>其中 \(\gamma = c_p / c_v\)。</p>

<h4>1.9</h4>
<p>证明对于静力平衡下的理想气体，干静能（\(M = c_p T + gz\)）的变化与势温（\(\theta\)）的变化之间存在如下关系：</p>
<p>
\[
\delta M = c_p \left(\frac{T}{\theta}\right) \delta \theta.
\]
</p>
<p>（其中 \(c_p T / \theta\) 被称为“埃克斯纳函数”）。</p>

<h4>1.10</h4>
<p>使用文本中给出的海水状态方程，或文献中获得的更精确的状态方程，估算由于压强、盐度和温度变化引起的全球海洋密度的分数变化。</p>

<h4>1.11</h4>
<p>使用从文献中获得的准确的状态方程（例如，来自 Vallis (2017) 或 IOC 等 (2010)），估算全球海洋密度误差（如(1.42)）的大小。</p>
<h1>第2章：旋转行星方程</h1>
<h2>2.1 旋转参考系中的运动方程</h2>

<p>牛顿第二定律指出，物体动量变化的速率与所施加的力成正比，这一定律适用于所谓的<strong>惯性参考系</strong>，这些参考系要么是静止的，要么仅以相对于遥远星系的恒定直线速度运动。</p>

<p>现在，地球每天绕其轴自转一次，因此地球表面并<strong>不是</strong>一个惯性参考系。然而，相对于地球表面来描述大气或海洋的运动比在某个惯性参考系中描述要方便得多。本节的主题就是讨论我们如何做到这一点。</p>

<h3>2.1.1 向量的变化率</h3>

<p>首先，考虑一个相对于惯性参考系以恒定角速度 <strong>Ω</strong> 旋转的恒定长度向量 <strong>C</strong>。在以相同角速度旋转的参考系中，它看起来是静止且恒定的。</p>

<p>如果在一个小时间间隔 <strong>δt</strong> 内，向量 <strong>C</strong> 绕一个小角度 <strong>δλ</strong> 旋转，那么在惯性参考系中感知到的 <strong>C</strong> 的变化由下式给出（见图2.1）：</p>

<p>
$$
\delta C = |C| \cos \vartheta \delta \lambda \mathbf{m}, \quad (2.1)
$$
</p>

<p>其中，向量 <strong>m</strong> 是指向 <strong>C</strong> 变化方向的单位向量，该方向垂直于 <strong>C</strong> 和 <strong>Ω</strong>。</p>

<p>但是，角度 <strong>λ</strong> 的变化率由角速度定义，因此：</p>

<p>
$$
\delta \lambda = |\Omega| \delta t,
$$
</p>

<p>并且有：</p>

<p>
$$
\delta C = |C||\Omega| \sin \vartheta \mathbf{m} \delta t = \Omega \times C \delta t. \quad (2.2)
$$
</p>
<h2>使用矢量叉积的定义</h2>

<p>其中，<strong>ϑ = (π/2 − ϑ)</strong> 是 <strong>Ω</strong> 和 <strong>C</strong> 之间的角度。因此，有：</p>

<p>
$$
\left(\frac{d \mathbf{C}}{d t}\right)_I = \mathbf{\Omega} \times \mathbf{C}, \quad (2.3)
$$
</p>

<p>这里，左侧表示在惯性参考系中观察到的向量 <strong>C</strong> 的变化率。</p>

<p>现在，考虑一个在惯性参考系中变化的向量 <strong>B</strong>。在一个小时间间隔 <strong>δt</strong> 内，旋转参考系中观察到的 <strong>B</strong> 的变化与惯性参考系中的变化相关，关系如下：</p>

<p>
$$
(\delta \mathbf{B})_I = (\delta \mathbf{B})_R + (\delta \mathbf{B})_{rot}, \quad (2.4)
$$
</p>

<p>其中，这些项分别表示：</p>
<ul>
  <li><strong>(\(\delta \mathbf{B})_I\)</strong>：在惯性参考系中观察到的变化。</li>
  <li><strong>(\(\delta \mathbf{B})_R\)</strong>：在旋转参考系中测量到的向量本身的变化。</li>
  <li><strong>(\(\delta \mathbf{B})_{rot}\)</strong>：由旋转引起的变化。</li>
</ul>

<p>根据公式 (2.2)，我们有：</p>

<p>
$$
(\delta \mathbf{B})_{rot} = \mathbf{\Omega} \times \mathbf{B} \delta t,
$$
</p>

<p>因此，向量 <strong>B</strong> 在惯性参考系和旋转参考系中的变化率之间的关系为：</p>

<p>
$$
\left(\frac{d \mathbf{B}}{d t}\right)_I = \left(\frac{d \mathbf{B}}{d t}\right)_R + \mathbf{\Omega} \times \mathbf{B}. \quad (2.5)
$$
</p>

<p>这个关系适用于向量 <strong>B</strong>，在任何时间点测量时，它在惯性参考系和旋转参考系中是相同的。</p>
<h3>2.1.2 旋转参考系中的速度和加速度</h3>
<p>
物体在惯性系和旋转系中的速度测量结果并不相同，因此在将(2.5)应用于速度时必须格外小心。首先将(2.5)应用于粒子的位置 <em>r</em>，可得到：
</p>

<p>
\[
\left(\frac{d\mathbf{r}}{dt}\right)_I = \left(\frac{d\mathbf{r}}{dt}\right)_R + \mathbf{\Omega} \times \mathbf{r}
\]
</p>

<p>
或者：
</p>
<p>
\[
\mathbf{v}_I = \mathbf{v}_R + \mathbf{\Omega} \times \mathbf{r}
\]
</p>
<p>
我们将 <em>v_R</em> 和 <em>v_I</em> 分别称为相对速度和惯性速度，公式(2.7)将两者联系起来。再次将(2.5)应用于速度 <em>v_R</em>，可得：
</p>
<p>
\[
\left(\frac{d\mathbf{v}_R}{dt}\right)_I = \left(\frac{d\mathbf{v}_R}{dt}\right)_R + \mathbf{\Omega} \times \mathbf{v}_R
\]
</p>
<p>
或者，使用(2.7)：
</p>
<p>
\[
\left(\frac{d}{dt}(\mathbf{v}_I - \mathbf{\Omega} \times \mathbf{r})\right)_I = \left(\frac{d\mathbf{v}_R}{dt}\right)_R + \mathbf{\Omega} \times \mathbf{v}_R
\]
</p>
<p>
或：
</p>
<p>
\[
\left(\frac{d\mathbf{v}_I}{dt}\right)_I = \left(\frac{d\mathbf{v}_R}{dt}\right)_R + \mathbf{\Omega} \times \mathbf{v}_R + \frac{d\mathbf{\Omega}}{dt} \times \mathbf{r} + \mathbf{\Omega} \times \left(\frac{d\mathbf{r}}{dt}\right)_I
\]
</p>
<p>
然后，注意到：
</p>
<p>
\[
\left(\frac{d\mathbf{r}}{dt}\right)_I = \left(\frac{d\mathbf{r}}{dt}\right)_R + \mathbf{\Omega} \times \mathbf{r} = (\mathbf{v}_R + \mathbf{\Omega} \times \mathbf{r})
\]
</p>
<p>
并假设旋转速率是恒定的，(2.10)变为：
</p>
<p>
\[
\left(\frac{d\mathbf{v}_R}{dt}\right)_R = \left(\frac{d\mathbf{v}_I}{dt}\right)_I - 2\mathbf{\Omega} \times \mathbf{v}_R - \mathbf{\Omega} \times (\mathbf{\Omega} \times \mathbf{r})
\]
</p>

<h4>解释</h4>
<p>
该方程可以解释如下：左侧项是在旋转参考系中测量的相对速度的变化率。右侧第一项是惯性系中测得的惯性速度的变化率（惯性加速度，根据牛顿第二定律，等于流体单元所受的力除以其质量）。右侧第二和第三项（包括负号）分别是<strong>科里奥利力</strong>和<strong>离心力</strong>（单位质量）。这两者通常不被视为真正的力——它们可以看作是准力（即“仿佛”的力）；也就是说，当从旋转参考系观察物体时，它表现得好像有某些看不见的力在影响其运动。
</p>

<h4>离心力</h4>
<p>
如果 <em>r⊥</em> 是到旋转轴的垂直距离（参见图2.1，并将 <em>r</em> 替换为 <em>r⊥</em>），因为 <em>Ω</em> 垂直于 <em>r⊥</em>，有：
</p>
<p>
\[
\mathbf{\Omega} \times \mathbf{r} = \mathbf{\Omega} \times \mathbf{r⊥}
\]
</p>
<p>
然后，使用向量恒等式：
</p>
<p>
\[
\mathbf{\Omega} \times (\mathbf{\Omega} \times \mathbf{r}) = (\mathbf{\Omega} \cdot \mathbf{r}) \mathbf{\Omega} - (\mathbf{\Omega} \cdot \mathbf{\Omega}) \mathbf{r}
\]
</p>
<p>
注意到第一项为零，可以得出单位质量的离心力为：
</p>
<p>
\[
\mathbf{F}_{ce} = -\mathbf{\Omega} \times (\mathbf{\Omega} \times \mathbf{r}) = \mathbf{\Omega}^2 r⊥
\]
</p>
<p>
这个公式可以写成标量势的梯度：
</p>
<p>
\[
\mathbf{F}_{ce} = -\nabla \Phi_{ce}
\]
</p>
<p>
其中：
</p>
<p>
\[
\Phi_{ce} = -\frac{(\mathbf{\Omega}^2 r⊥^2)}{2} = -\frac{(\mathbf{\Omega} r⊥)^2}{2}
\]
</p>
<h4><em>科里奥利力</em></h4>
<p>
科里奥利力的单位质量形式为：
</p>

<p>
\[
\mathbf{F}_{co} = -2\mathbf{\Omega} \times \mathbf{v}_R
\]
</p>
<p>
我们将广泛讨论科里奥利力的影响，但现在仅需注意三个基本性质：
</p>
<ol>
  <li>在旋转参考系中静止的物体不会受到科里奥利力的作用。</li>
  <li>科里奥利力会使运动物体的轨迹发生偏转，其方向与物体的运动方向成直角。</li>
  <li>科里奥利力对物体不做功，因为它与速度成垂直方向。因此：
  \[
  \mathbf{v}_R \cdot (\mathbf{\Omega} \times \mathbf{v}_R) = 0
  \]</li>
</ol>

<h3>2.1.3 旋转参考系中的运动方程</h3>

<h4><em>动量方程</em></h4>
<p>
由于(2.12)简单地关联了惯性系和旋转系中粒子的加速度，那么在旋转参考系中，三维动量方程可写为：
</p>

<p>
\[
\frac{D\mathbf{v}}{Dt} + 2\mathbf{\Omega} \times \mathbf{v} = -\frac{1}{\rho} \nabla p - \nabla \Phi_{ce} + \mathbf{g}
\]
</p>

<p>
所有的速度和加速度均相对于惯性系进行测量。由于离心项不会随着流体的运动而变化，我们可以将其纳入重力项 <em>g</em> 中，从而得到一个随地球表面位置略有变化的“有效重力”。
</p>

<h4><em>质量连续性方程与热力学方程</em></h4>
<p>
质量守恒方程和热力学方程在旋转参考系中不会发生改变。为了证明这一点，请考虑某个变量 φ（例如温度或密度）的物质导数。物质导数只是某个可识别的流体单元中 φ 的变化率，这显然不依赖于参考系。因此，可以写成：
</p>

<p>
\[
\left(\frac{D\varphi}{Dt}\right)_R = \left(\frac{D\varphi}{Dt}\right)_I
\]
</p>

<p>
其中，物质导数可表示为：
</p>
<p>
\[
\left(\frac{D\varphi}{Dt}\right)_R = \left(\frac{\partial \varphi}{\partial t}\right)_R + \mathbf{v}_R \cdot \nabla \varphi
\]
</p>
<p>
\[
\left(\frac{D\varphi}{Dt}\right)_I = \left(\frac{\partial \varphi}{\partial t}\right)_I + \mathbf{v}_I \cdot \nabla \varphi
\]
</p>

<p>
这两个参考系中的各个项有所不同：在旋转系中为 \(\left(\frac{\partial \varphi}{\partial t}\right)_R\)，而在惯性系中为 \(\left(\frac{\partial \varphi}{\partial t}\right)_I\)，但物质导数是相等的。
</p>

<p>
此外，散度算子在惯性系和旋转系中是相同的。根据(2.7)，我们有：
</p>

<p>
\[
\nabla \cdot \mathbf{v}_I = \nabla \cdot (\mathbf{v}_R + \mathbf{\Omega} \times \mathbf{r}) = \nabla \cdot \mathbf{v}_R
\]
</p>

<p>
因为：
</p>
<p>
\[
\nabla \cdot (\mathbf{\Omega} \times \mathbf{r}) = 0
\]
</p>

<p>
因此，结合(2.17)和(2.18)，质量守恒方程(1.27b)可写为：
</p>

<p>
\[
\frac{D\rho}{Dt} + \rho \nabla \cdot \mathbf{v}_R = 0
\]
</p>


<h4><em>历史背景</em></h4>
<p>
科里奥利力以加斯帕尔-古斯塔夫·德·科里奥利（Gaspard-Gustave de Coriolis，1792-1843）的名字命名，他在1835年首次在工程背景下讨论了这一效应，尽管这一基本效应最早由莱昂哈德·欧拉（Leonhard Euler，1707-1783）在数学中识别出来。拉普拉斯（Laplace）在1776年的潮汐方程中也包含了这一项，后于1832年以英文出版。威廉·费雷尔（William Ferrel，1817-1891）或许是第一个认识到科里奥利力对地球环流影响的人，并在拉普拉斯方程中识别和讨论了相关项 \((2\Omega u \sin \theta)\)。
</p>
<p>
同样，<strong>热力学方程</strong>也是在<strong>旋转参考系</strong>中测量所有可观测量的。
</p>
<p>
也就是说，<strong>质量守恒方程</strong>和<strong>热力学方程</strong>并不会因为旋转的存在而发生改变。
</p>
<p>
更一般地说，<strong>标量演化方程</strong>在<strong>旋转参考系</strong>和<strong>惯性参考系</strong>中是相同的，不受旋转的影响。
</p>
<h3>2.2 球坐标系中的运动方程</h3>

<p>
由于地球以及我们所知的大多数其他行星非常接近球形，我们通常在球坐标系中表示方程。我们很少完全使用方程的球坐标形式，但我们的近似值直接源自这些方程。信任的读者可以跳过推导，直接查看主要结果，如(2.34)、(2.35)和(2.40)所示。
</p>

<h4>2.2.1 球坐标系中的一些恒等式</h4>

<p>
一个点的位置由坐标 \((λ, θ, r)\) 给出，其中：
</p>
<ul>
    <li><strong>λ</strong> 是向东的角度距离（即，经度）。</li>
    <li><strong>θ</strong> 是向极点的角度距离（即，纬度）。</li>
    <li><strong>r</strong> 是从地球中心到该点的径向距离。</li>
</ul>

<p>
（在其他一些研究领域中，余纬度也被用作球面坐标）。如果 <em>a</em> 是地球半径，则我们还可以定义 <em>z = r - a</em>。在给定位置，我们也可以定义笛卡尔增量 \((δx, δy, δz) = (r \cos θ δλ, r δθ, δr)\)。
</p>

<p>
对于一个标量变量 \(\varphi\)，其在球坐标系中的物质导数为：
</p>

<p>
\[
\frac{D \varphi}{Dt} = \frac{\partial \varphi}{\partial t} + \frac{u}{r \cos \theta} \frac{\partial \varphi}{\partial \lambda} + \frac{v}{r} \frac{\partial \varphi}{\partial \theta} + w \frac{\partial \varphi}{\partial r}
\]
</p>

<p>
其中，速度分量与坐标 \((λ, θ, r)\) 对应为：
</p>

<p>
\[
(u, v, w) \equiv \left(r \cos \theta \frac{D \lambda}{Dt}, r \frac{D \theta}{Dt}, \frac{D r}{Dt}\right)
\]
</p>

<p>
也就是说，<em>u</em> 是纬向速度，<em>v</em> 是经向速度，<em>w</em> 是垂直速度。如果我们将 \((\mathbf{i}, \mathbf{j}, \mathbf{k})\) 定义为沿着 \((λ, θ, r)\) 增加方向的单位向量，那么：
</p>

<p>
\[
\mathbf{v} = \mathbf{i} u + \mathbf{j} v + \mathbf{k} w
\]
</p>

<p>
还要注意：
</p>
<p>
\[
\frac{Dr}{Dt} = \frac{Dz}{Dt}
\]
</p>

<p>
向量 \(\mathbf{B} = \mathbf{i} B^\lambda + \mathbf{j} B^\theta + \mathbf{k} B^r\) 的散度为：
</p>

<p>
\[
\nabla \cdot \mathbf{B} = \frac{1}{\cos \theta} \left[\frac{1}{r} \frac{\partial (B^\lambda r \cos \theta)}{\partial \lambda} + \frac{1}{r} \frac{\partial (B^\theta \cos \theta)}{\partial \theta} + \frac{\cos \theta}{r^2} \frac{\partial (r^2 B^r)}{\partial r}\right]
\]
</p>

<p>
标量的梯度为：
</p>

<p>
\[
\nabla \varphi = \mathbf{i} \frac{1}{r \cos \theta} \frac{\partial \varphi}{\partial \lambda} + \mathbf{j} \frac{1}{r} \frac{\partial \varphi}{\partial \theta} + \mathbf{k} \frac{\partial \varphi}{\partial r}
\]
</p>

<p>
标量的拉普拉斯为：
</p>

<p>
\[
\nabla^2 \varphi = \frac{1}{r^2 \cos \theta} \left[\frac{1}{\cos \theta} \frac{\partial^2 \varphi}{\partial \lambda^2} + \frac{\partial}{\partial \theta} \left(\cos \theta \frac{\partial \varphi}{\partial \theta}\right) + \cos \theta \frac{\partial}{\partial r} \left(r^2 \frac{\partial \varphi}{\partial r}\right)\right]
\]
</p>
<h3>向量的旋度</h3>

<p>
向量的旋度表示为：
</p>

<p>
\[
\mathbf{curl} \, \mathbf{B} = \nabla \times \mathbf{B} = \frac{1}{r^2 \cos \theta} 
\begin{vmatrix}
\mathbf{i} & r \cos \theta & \frac{\partial}{\partial \lambda} \\
\mathbf{j} & r & \frac{\partial}{\partial \theta} \\
\mathbf{k} & 1 & \frac{\partial}{\partial r}
\end{vmatrix}
\]
</p>

<p>
向量拉普拉斯 \(\nabla^2 \mathbf{B}\)（例如在计算动量方程中黏性项时使用）可以由以下向量恒等式得到：
</p>

<p>
\[
\nabla^2 \mathbf{B} = \nabla (\nabla \cdot \mathbf{B}) - \nabla \times (\nabla \times \mathbf{B})
\]
</p>

<p>
只有在笛卡尔坐标系中，它才具有简单的形式：
</p>

<p>
\[
\nabla^2 \mathbf{B} = \frac{\partial^2 \mathbf{B}}{\partial x^2} + \frac{\partial^2 \mathbf{B}}{\partial y^2} + \frac{\partial^2 \mathbf{B}}{\partial z^2}
\]
</p>

<p>
球坐标系中的展开式本身对大多数人来说缺乏直观性。
</p>

<h4>单位向量的变化率</h4>

<p>
在球坐标中，定义单位向量为：
</p>
<ul>
    <li><strong>\(\mathbf{i}\)</strong>：指向东方，平行于纬度线。</li>
    <li><strong>\(\mathbf{j}\)</strong>：指向北方，平行于子午线。</li>
    <li><strong>\(\mathbf{k}\)</strong>：径向指向外侧。</li>
</ul>

<p>
这些向量的方向随着位置而变化，这在几乎所有坐标系中都成立，唯独在笛卡尔坐标系中例外。因此，它们的物质导数不为零。
</p>

<h4>有效旋转速率</h4>

<p>
一种评估这些变化的方法是首先确定相对于地球的单位向量的有效旋转速率 \(\Omega_{flow}\)，即向量随流动而变化的速率，然后应用(2.3)。
</p>

<p>
具体来说，设流体速度为：
</p>
<p>
\[
\mathbf{v} = (u, v, w)
\]
</p>

<p>
其中：
<ul>
    <li><strong>u</strong>：纬向速度</li>
    <li><strong>v</strong>：经向速度</li>
    <li><strong>w</strong>：垂直速度</li>
</ul>
</p>

<p>
经向分量 \(v\) 产生一个位移：
</p>
<p>
\[
r δθ = v δt
\]
</p>

<p>
这导致局部有效旋转速率围绕局部纬向轴为：
</p>
<p>
\[
-\frac{v}{r} \mathbf{i}
\]
</p>

<p>
同样，纬向分量 \(u\) 产生一个位移：
</p>
<p>
\[
δλ r \cos \theta = u δt
\]
</p>

<p>
从而产生一个绕地球旋转轴的有效旋转速率：
</p>
<p>
\[
\frac{u}{r \cos \theta}
\]
</p>

<p>
因此，围绕地球旋转轴的旋转可以表示为：
</p>
<p>
\[
\mathbf{\Omega} = \Omega (\mathbf{j} \cos \theta + \mathbf{k} \sin \theta)
\]
</p>

<p>
如果标量旋转速率不是 \(\Omega\) 而是 \(\frac{u}{r \cos \theta}\)，则向量旋转速率为：
</p>

<p>
\[
\frac{u}{r \cos \theta} (\mathbf{j} \cos \theta + \mathbf{k} \sin \theta) = \mathbf{j} \frac{u}{r} + \mathbf{k} \frac{u \tan \theta}{r}
\]
</p>

<p>
因此，随流动移动的向量的总旋转速率为：
</p>
<p>
\[
\mathbf{\Omega}_{flow} = -\mathbf{i} \frac{v}{r} + \mathbf{j} \frac{u}{r} + \mathbf{k} \frac{u \tan \theta}{r}
\]
</p>

<p>
将(2.3)应用于(2.31)，我们得到：
</p>

<p>
\[
\frac{D \mathbf{i}}{Dt} = \Omega_{flow} \times \mathbf{i} = \frac{u}{r \cos \theta} (\mathbf{j} \sin \theta - \mathbf{k} \cos \theta)
\]
</p>

<p>
\[
\frac{D \mathbf{j}}{Dt} = \Omega_{flow} \times \mathbf{j} = -\mathbf{i} \frac{u}{r} \tan \theta - \mathbf{k} \frac{v}{r}
\]
</p>

<p>
\[
\frac{D \mathbf{k}}{Dt} = \Omega_{flow} \times \mathbf{k} = \mathbf{i} \frac{u}{r} + \mathbf{j} \frac{v}{r}
\]
</p>
